import { transformTsCode } from "../src/transformer";

describe("转换器测试", () => {
  const testCode = `const add = (a: number, b: number): number => a + b;`;
  const testFile = "test.ts";

  test("应正确转译TS代码为JS", () => {
    const result = transformTsCode(testFile, testCode);
    expect(result.code).toContain("const add = (a, b) => a + b;");
    expect(result.code).not.toContain(": number"); // 类型应被移除
  });

  test("缓存机制应正常工作", () => {
    // 首次执行
    const result1 = transformTsCode(testFile, testCode);
    // 二次执行（应命中缓存）
    const result2 = transformTsCode(testFile, testCode);
    
    expect(result1.code).toBe(result2.code);
  });
});
